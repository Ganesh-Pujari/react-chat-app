(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{111:function(e,t,n){},112:function(e,t,n){},117:function(e,t,n){},123:function(e,t,n){},126:function(e,t,n){},127:function(e,t,n){},131:function(e,t,n){"use strict";n.r(t);var s=n(4),c=n.n(s),a=n(44),r=n.n(a),i=(n(111),n(17)),o=(n(112),n(47)),u=(n(132),n(115),n(87)),j=n(88),l=n(1),b=n.n(l),d=n(2),f=(n(117),n(166)),p=n(90),O=n.n(p),h=n(91),g=n.n(h),x=n(89),m=n.n(x),v=n(8);function S(e){var t=Object(s.useState)(null),n=Object(i.a)(t,2),c=n[0],a=n[1],r=function(t,n){a(null),e.getSelectedOption(t,e.id,e.message)},o=Boolean(c),u=o?"simple-popover":void 0;return Object(v.jsxs)("div",{className:"popover-body",children:[Object(v.jsx)(m.a,{color:"light","aria-describedby":u,variant:"contained",onClick:function(e){a(e.currentTarget)},className:"dot-icon"}),Object(v.jsx)(f.a,{id:u,open:o,anchorEl:c,onClose:function(){a(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},children:Object(v.jsxs)("div",{className:"popover-text",children:[Object(v.jsxs)("h6",{onClick:function(e){return r("edit")},children:[Object(v.jsx)(O.a,{}),"Edit"]}),Object(v.jsxs)("h6",{onClick:function(e){return r("delete")},children:[Object(v.jsx)(g.a,{}),"Delete"]})]})})]})}var k=function(e){var t=Object(s.useState)(!1),n=Object(i.a)(t,2),c=n[0],a=n[1],r=e.firebase.auth(),o=e.message,u=o.text,j=o.uid,l=o.photoURL,f=o.id,p=j===r.currentUser.uid?"sent":"received",O=function(){var t=Object(d.a)(b.a.mark((function t(n,s,c){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("edit"!==n||!c){t.next=4;break}e.updateMessage({id:s,message:c}),t.next=6;break;case 4:return t.next=6,e.firestore.collection("messages").doc(s).delete();case 6:a(!1);case 7:case"end":return t.stop()}}),t)})));return function(e,n,s){return t.apply(this,arguments)}}();return Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"message ".concat(p),children:[Object(v.jsx)("img",{src:l}),c&&j===r.currentUser.uid?Object(v.jsx)(S,{getSelectedOption:O,id:f,message:u}):null,Object(v.jsxs)("p",{onClick:function(){return a(!c)},children:[u," "]})]})})},C=n(94);n(123),n(169),n(167),n(171),n(165),n(170),n(93);var y=function(e){console.log("TCL ->  ~ file: MessageBox.js ~ line 6 ~ MessageBox ~ props",e);var t=e.firestore.collection("messages");console.log("TCL ->  ~ file: MessageBox.js ~ line 8 ~ MessageBox ~ messagesRef",t);var n=e.firebase,c=e.text,a=e.messageId,r=Object(s.useState)(""),o=Object(i.a)(r,2),u=o[0],j=o[1],l=function(){var s=Object(d.a)(b.a.mark((function s(r){var i,o,l,d;return b.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(j(""),r.preventDefault(),i=n.auth().currentUser,o=i.uid,l=i.photoURL,d={text:u,createdAt:n.firestore.FieldValue.serverTimestamp(),uid:o,photoURL:l},c){s.next=9;break}return s.next=7,t.add(d);case 7:s.next=12;break;case 9:return s.next=11,e.firestore.collection("messages").doc(a).update(d);case 11:e.updateMessage({id:null,message:null});case 12:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}();return Object(s.useEffect)((function(){c&&j(c)}),[c]),Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("form",{onSubmit:l,children:[Object(v.jsx)("input",{value:u,onChange:function(e){return j(e.target.value)},placeholder:"Type message..."}),Object(v.jsxs)("button",{type:"submit",disabled:!u,children:[" ",Object(v.jsx)(C.a,{}),"Send"]})]})})};n(126);var w=function(e){var t=Object(s.useState)([]),n=Object(i.a)(t,2),c=n[0],a=n[1],r=e.firestore,o=e.firebase,u=Object(s.useState)(""),l=Object(i.a)(u,2),b=l[0],d=l[1],f=Object(s.useState)(""),p=Object(i.a)(f,2),O=p[0],h=p[1],g=Object(s.useRef)(),x=function(e){var t=e.id,n=e.message;h(t),d(n)};return Object(s.useEffect)((function(){g.current.scrollIntoView({behavior:"smooth"})}),[c]),Object(s.useEffect)((function(){r.collection("messages").orderBy("createdAt","asc").onSnapshot((function(e){a(e.docs.map((function(e){return Object(j.a)({id:e.id},e.data())})))}))}),[]),Object(v.jsxs)(v.Fragment,{children:[Object(v.jsxs)("main",{children:[c&&c.map((function(e){return Object(v.jsx)(k,{message:e,firebase:o,firestore:r,updateMessage:x},e.id)})),Object(v.jsx)("span",{ref:g})]}),Object(v.jsx)(y,{firebase:o,firestore:r,text:b,messageId:O,updateMessage:x})]})},I=n(95);n(127);var L=function(e){var t=e.firebase;return Object(v.jsx)("div",{children:Object(v.jsxs)("button",{onClick:function(){var e=new t.auth.GoogleAuthProvider;t.auth().signInWithPopup(e)},children:[Object(v.jsx)(I.a,{})," Sign in with Google account"]})})},T=(n(128),n(96));var U=function(e){var t=e.firebase.auth();console.log("TCL ->  ~ file: SignOut.js ~ line 6 ~ SignOut ~ auth",t),e.firestore;var n=e.firestore.collection("messages");return console.log("TCL ->  ~ file: SignOut.js ~ line 8 ~ SignOut ~ messagesRef",n),t.currentUser&&Object(v.jsxs)("div",{className:"sign-out",children:[Object(v.jsx)("img",{src:t.currentUser.photoURL}),Object(v.jsx)("h6",{children:t.currentUser.displayName}),Object(v.jsxs)("button",{className:"sign-out-btn",onClick:function(){return t.signOut()},children:[" ",Object(v.jsx)(T.a,{})," Sign Out"]})]})},B={apiKey:"AIzaSyD-jy4Ov4hs12SZZT17oKf13HHEQKAQWq8",authDomain:"react-chat-app-5bf77.firebaseapp.com",projectId:"react-chat-app-5bf77",storageBucket:"react-chat-app-5bf77.appspot.com",messagingSenderId:"9887463294",appId:"1:9887463294:web:60a44a29840262aec3e52f"};o.a.initializeApp(B);var F=function(){var e=o.a.auth(),t=o.a.firestore(),n=Object(u.a)(e),c=Object(i.a)(n,1)[0],a=Object(s.useState)("light"),r=Object(i.a)(a,2);return r[0],r[1],Object(v.jsx)(v.Fragment,{children:Object(v.jsxs)("div",{className:"App",children:[Object(v.jsx)("header",{className:"App-header",children:Object(v.jsx)(U,{firebase:o.a,firestore:t})}),Object(v.jsx)("section",{children:c?Object(v.jsx)(w,{firestore:t,firebase:o.a}):Object(v.jsx)(L,{firebase:o.a})})]})})},M=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,172)).then((function(t){var n=t.getCLS,s=t.getFID,c=t.getFCP,a=t.getLCP,r=t.getTTFB;n(e),s(e),c(e),a(e),r(e)}))};n(129);r.a.render(Object(v.jsx)(c.a.StrictMode,{children:Object(v.jsx)(F,{})}),document.getElementById("root")),M()}},[[131,1,2]]]);
//# sourceMappingURL=main.2e17d4e0.chunk.js.map